<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="jp.co.lyc.cms.mapper.GetSiteInfoMapper">

	<insert id="siteInsert" parameterType="map">
		insert into
		T006EmployeeSiteInfo(employeeNo,siteNo,customerNo,topCustomerNo,admissionStartDate,admissionEndDate,
		siteManager,systemName,developLanguage,location,unitPrice,siteRoleCode,payOffRange,relatedEmployees,
		levelCode,updateTime,createTime,updateUser)
		values(#{employeeNo},#{siteNo},#{customerNo},#{topCustomerNo},#{admissionStartDate},#{admissionEndDate},
		#{siteManager},#{systemName},#{developLanguage},#{location},#{unitPrice},#{siteRoleCode},#{payOffRange},
		#{relatedEmployees},#{levelCode},now(),now(),"LYC001")
	</insert>

	<update id="siteUpdate" parameterType="map">
		update account_information
		set
		bankCode=#{bankCode},bankBranchCode=#{bankBranchCode},accountNo=#{accountNo},accountName=#{accountName},updateDate=now()
		where employeeNo=#{employeeNo}

	</update>

	<select id="getSiteInfo" parameterType="java.lang.String"
		resultType="jp.co.lyc.cms.model.SiteModel">
		SELECT
		a.systemName,
		a.location,
		a.unitPrice,
		a.admissionStartDate,
		a.admissionEndDate,
		b.siteRoleName,
		if(c.customerAbbreviation is
		null,c.customerName,c.customerAbbreviation) as customerName,
		if(d.topCustomerAbbreviation is
		null,d.topCustomerName,d.topCustomerAbbreviation) as topCustomerName,
		a.developLanguage
		FROM
		rams.T006EmployeeSiteInfo a
		LEFT JOIN
		rams.M012SiteRole b
		ON a.siteRoleCode = b.siteRoleCode
		LEFT JOIN
		rams.T007CustomerInfo c ON
		a.customerNo = c.customerNo
		LEFT JOIN
		rams.T008TopCustomerInfo d ON
		a.topCustomerNo = d.topCustomerNo
		WHERE
		1=1
		<if test="employeeNo!= null and employeeNo!= ''">
			AND a.employeeNo = #{employeeNo}
		</if>

	</select>


</mapper>