<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="jp.co.lyc.cms.mapper.GetSelectInfoUtilMapper">
	<!-- 社員形式コード -->
	<select id="getStaffForms"
		resultType="jp.co.lyc.cms.model.ModelClass">
		SELECT employeeFormCode code,employeeFormName name FROM
		M005EmployeeForm;
	</select>
	<!-- 在留資格 -->
	<select id="getVisa" resultType="jp.co.lyc.cms.model.ModelClass">
		SELECT visaCode code,visaName
		name FROM M006Visa;
	</select>
	<!--国籍 -->
	<select id="getNationalitys"
		resultType="jp.co.lyc.cms.model.ModelClass">
		SELECT nationalityCode code,nationalityName name FROM
		M003Nationality;
	</select>
	<!--お客様 -->
	<select id="getCustomer"
		resultType="jp.co.lyc.cms.model.ModelClass">
		SELECT customerRankingCode code,customerRankingName name
		FROM customer_ranking_master;
	</select>

	<!-- 開発言語 -->
	<select id="getTechnologyType" parameterType="map"
		resultType="jp.co.lyc.cms.model.ModelClass">
		SELECT technologytypeCode code,technologytypeName name FROM
		M011TechnologyType where 1=1
		<if test="developmentLanguageNo1!= null">
			AND technologytypeName like
			concat('%',#{developmentLanguageNo1},'%');
		</if>
		<if test="developmentLanguageNo2!= null">
			AND technologytypeName like
			concat('%',#{developmentLanguageNo2},'%');
		</if>
		<if test="developmentLanguageNo3!= null">
			AND technologytypeName like
			concat('%',#{developmentLanguageNo3},'%');
		</if>
	</select>

	<!--日本語レベル -->
	<select id="getJapaneseLevel"
		resultType="jp.co.lyc.cms.model.ModelClass">
		SELECT japaneseLevelCode code,japaneseLevelName name FROM
		M010JapaneseLevel;
	</select>

	<!--入社区分 -->
	<select id="getIntoCompany"
		resultType="jp.co.lyc.cms.model.ModelClass">
		SELECT intoCompanyCode code,intoCompanyName name FROM
		M004IntoCompany;
	</select>
	<!-- 役割 -->
	<select id="getSiteMaster"
		resultType="jp.co.lyc.cms.model.ModelClass">
		SELECT siteRoleCode code,siteRoleName name FROM
		M012SiteRole;
	</select>
	<!-- 職種 -->
	<select id="getOccupation"
		resultType="jp.co.lyc.cms.model.ModelClass">
		SELECT occupationCode code,occupationName name FROM
		M014Occupation;
	</select>
	<!-- 部署 -->
	<select id="getDepartment"
		resultType="jp.co.lyc.cms.model.ModelClass">
		SELECT DepartmentCode code,DepartmentName name FROM
		M017Department;
	</select>
	<!-- 権限 -->
	<select id="getAuthority"
		resultType="jp.co.lyc.cms.model.ModelClass">
		SELECT authorityCode code,authorityName name FROM
		M009Authority;
	</select>
	<!-- 英語 -->
	<select id="getEnglishLevel"
		resultType="jp.co.lyc.cms.model.ModelClass">
		SELECT englishLevelCode code,englishLevelName name FROM
		M015EnglishLevel;
	</select>
	<!-- 資格 -->
	<select id="getQualification"
		resultType="jp.co.lyc.cms.model.ModelClass">
		SELECT qualificationCode code,qualificationName name FROM
		M016Qualification;
	</select>

	<!-- 精算時間 -->
	<select id="getPayMaster"
		resultType="jp.co.lyc.cms.model.ModelClass">
		SELECT payOffRangeCode code,payOffRangeName name FROM
		rams.payoff_Range_master;
	</select>
	<!-- お客様ランキン -->
	<select id="selectCustomerRanking"
		resultType="jp.co.lyc.cms.model.ModelClass">
		SELECT
		customerRankingCode code,
		customerRankingName name
		FROM
		M008CustomerRanking
	</select>

	<!-- 会社性質選択肢 -->
	<select id="selectCompanyNature"
		resultType="jp.co.lyc.cms.model.ModelClass">
		SELECT
		companyNatureCode code,
		companyNatureName name
		FROM
		M007CompanyNature
	</select>
	<!-- 職位選択肢 -->
	<select id="selectPosition"
		resultType="jp.co.lyc.cms.model.ModelClass">
		SELECT
		positionCode code,
		positionName name
		FROM
		M019Position
	</select>
	<!-- 上位お客様連想 -->
	<select id="selectTopCustomer"
		resultType="jp.co.lyc.cms.model.ModelClass" parameterType="String">
		SELECT
		topCustomerName name,
		topCustomerNo code
		FROM
		T008TopCustomerInfo
		WHERE
		topCustomerName LIKE concat('%',#{name},'%')
	</select>
	<!-- 部門名前連想 -->
	<select id="selectDepartmentMaster"
		resultType="jp.co.lyc.cms.model.ModelClass" parameterType="String">
		SELECT
		customerDepartmentName name,
		customerDepartmentCode code
		FROM
		M018CustomerDepartment
		WHERE
		customerDepartmentName LIKE concat('%',#{name},'%')
	</select>
	<!-- 銀行名検索 -->
	<select id="selectBankInfo"
		resultType="jp.co.lyc.cms.model.ModelClass">
		SELECT
		bankName name,
		bankCode code
		FROM
		M001Bank
	</select>
	<!-- 支店情報検索 -->
	<select id="getBankBranchInfo"
		resultType="jp.co.lyc.cms.model.ModelClass" parameterType="map">
		SELECT
		M002.bankBranchName name,
		M002.bankBranchCode code
		FROM
		M002BankBranch AS M002
		LEFT JOIN
		M001Bank AS M001
		ON
		M001.bankCode = M002.bankCode
		WHERE
		M002.bankCode = #{bankCode}
		<if test="bankBranchCode != null">
			AND M002.bankBranchCode = #{bankBranchCode}
		</if>
		<if test="bankBranchName != null">
			AND M002.bankBranchName = #{bankBranchName}
		</if>
	</select>
	<!-- トップお客様 -->
	<select id="getTopCustomer"
		resultType="jp.co.lyc.cms.model.ModelClass">
		SELECT topCustomerNo code,if(topCustomerAbbreviation is
		null,topCustomerName,topCustomerAbbreviation) name FROM
		rams.top_customer;
	</select>
	<!-- お客様 -->
	<select id="getCustomerMaster"
		resultType="jp.co.lyc.cms.model.ModelClass">
		SELECT customerNo code,if(customerAbbreviation is
		null,customerName,customerAbbreviation) name FROM
		rams.customer_information;
	</select>

	<!--採番 -->
	<select id="getNO" resultType="String" parameterType="map"
		statementType="STATEMENT">
		SELECT
		(CASE
		WHEN
		(CONVERT(SUBSTRING(a.${columnName}, 4)
		,SIGNED) + 1) &lt;10 THEN
		CONCAT(CONCAT('${typeName}','00'),(CONVERT(SUBSTRING(a.${columnName},
		4) , SIGNED) + 1))
		WHEN
		(CONVERT(SUBSTRING(a.${columnName}, 4) , SIGNED)
		+ 1 &gt;=10) AND (CONVERT(SUBSTRING(a.${columnName}, 4)
		, SIGNED) + 1
		&lt;100)
		THEN CONCAT(CONCAT('${typeName}','0'),(CONVERT(
		SUBSTRING(a.${columnName},
		4) , SIGNED) + 1))
		ELSE
		CONCAT('${typeName}',(CONVERT( SUBSTRING(a.${columnName}, 4) , SIGNED)
		+ 1)) END) no
		FROM
		${table} a
		WHERE
		${columnName} = (SELECT
		MAX(${columnName}) FROM ${table}) LIMIT 1 OFFSET 0;
	</select>
</mapper>